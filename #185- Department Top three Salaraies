with ranked as (
    select d.name as Department, e.name as Employee, e.salary as Salary,
    dense_rank() over (partition by d.name order by e.salary desc) as rnk
    from Employee e JOIN Department d 
    ON e.departmentId = d.id)

select Department, Employee, Salary
from ranked
where rnk <=3
